#!/usr/bin/env ruby

Space = Struct.new(:char, :position, :up, :left, :down, :right) do
  def initialize(char, position, up, left,down=nil,right=nil)
    super
    self.left = left
    self.up = up
  end

  def left=(other)
    other.right = self if other
    @left = other
  end
  
  def up=(other)
    other.down = self if other
    @up = other
  end
  
  def opposite(dir)
    case dir
    when :up then :down
    when :left then :right
    when :down then :up
    when :right then :left
    end
  end
  
  def next(dir)
#    can_turn = char == '+'
    
    all_dirs = [dir] + [:down, :up, :left, :right]
    all_dirs.uniq!
    all_dirs.delete(opposite(dir))
#    pp [self.position, all_dirs, dir, self.char] if all_dirs.map{|s| send(s)&.position&.== [21,51]}.any?
#    if in_dir && in_dir.blank? && can_turn
      d, n = all_dirs.map { |d| [d, send(d)] }.find { |_, n| n && !n.blank? }
      # if d != dir && char != '+'
      #   raise "cannot turn on #{self} from #{dir} to #{d} at #{position} -- options were "
      # end
      [d, n] if d
#    else
#      [d, in_dir]
#    end
  end
  
  def to_s
    "#{char} at #{position} -- #{[left, right, up, down].compact.map { |n| "#{n.position} (#{n.char})" }}"
  end
  
  def blank?
    char == ' '
  end
  
  def letter?
    ('A'..'Z').cover?(char)
  end
  
  def starting_dir
    return unless %w[| -].include?(char)
    dirs = [:up, :left, :down, :right].map { |d| [d, send(d)] }.select {|_,x| x && !x.blank? }.map(&:first)
    return unless dirs.size == 1
    dirs.first
  end
end

#pp DATA.read.chars.uniq

pts = {}
diagram = DATA.readlines.each_with_index.flat_map do |line, y|
  line.each_char.each_with_index.map do |c, x|
    next if c == ?\n
    pos = [x,y]
    pts[pos] = Space.new(c, pos, pts[[x, y.pred]], pts[[x.pred, y]])
  end.compact
end

def print_diagram(pts, highlight)
  system 'clear'
  require 'rubygems'
  require 'colored'
  0.upto(201) do |y|
    0.upto(201) do |x|
      c = pts[[x,y]]&.char
      c = c&.red if highlight == [x,y]
      print c
    end
    puts
  end
end


start = diagram.find(&:starting_dir)
#puts start
starting_dir = start.starting_dir

letters = ''
space = start
dir = starting_dir
steps = 0
loop do
#  print_diagram(pts, space.position)
#  pp [space.char, dir, space.position]
#  raise "dup pt #{space.position}" unless seen.add?(space.position)
  letters << space.char if space.letter?
  steps += 1
  break unless n = space.next(dir)
  dir, space = n
end

puts letters
puts steps

__END__
                                                                                                  |                                                                                                     
+-------------------+               +-+ +-------+       +-------------------+                     |                                         +---+                                   +-----+       +---+ 
|                   |               | | |       |       |                   |                     |                                         |   |                                   |     |       |   | 
|         +---+     |   +---------------|-------|-----------------------+ +-----------------------------+                                   |   |                                   |     |       |   | 
|         |   |     |   |           | | |       |       |               | | |                     |     |                                   |   |                                   |     |       |   | 
|         |   +---------------------|-----------------------------------|-------------------------------------------------------------------|-----------------+           +-----------------------+   | 
|         |         |   |           | | |       |       |               | | |                     |     |                                   |   |             |           |         |     |           | 
|         |         |   +-------------|-|---------------|---------------|---|---------------------------|-------------------------+         |   |             |         +-|---------|-------------+   | 
|         |         |               | | |       |       |               | | |                     |     |                         |         |   |             |         | |         |     |       |   | 
|   +-------------------------------|-----------|-------|---------------|---|---------------------|-----|-----------------------------------|---|-------------+ +-------+ |         +-----|---+   |   | 
|   |     |         |               | | |       |       |               | | |                     |     |                         |         |   |               |         |               |   |   |   | 
|   +-+   |         |               | | |       |       |               +-+ |                     |     | +---------------------------------|---|---------------+         |               |   |   | +-+ 
|     |   |         |               | | |       |       |                   |                     |     | |                       |         |   |                         |               |   |   | |   
|     |   |         |               | | |   +---|-------|-------------------|---------------------|-----|-|---------------------------+     | +-|-------------+           | +-----+       |   |   | |   
|     |   |         |               | | |   |   |       |                   |                     |     | |                       |   |     | | |             |           | |     |       |   |   | |   
| +---|-------------------------------|-|---------------|---------------+   |                   +---------------------+           +-------+ +-|-|-------------------------|-|-----|---------------|---+ 
| |   |   |         |               | | |   |   |       |               |   |                   | |     | |           |               |   |   | |             |           | |     |       |   |   | | | 
| |   +---|-------------------------|---|---|-------------------------------|-+               +-----+ +-|-----------------------------|-------|---------------|-----------|-|-----+       |   |   | | | 
| |       |         |               | | |   |   |       |               |   | |               | | | | | | |           |               |   |   | |             |           | |             |   |   | | | 
| | +---+ | +-+     |               | | |   |   |       |       +-----------|-+               | +-|-----|---------------+             |   |   | |             |           | |             |   |   | | | 
| | |   | | | |     |               | | |   |   |       |       |       |   |                 |   | | | | |           | |             |   |   | |             |           | |             |   |   | | | 
| | |   | | | |     |     +---+     | | |   |   |       |       |       |   |       +---------|---|---|-|---------------|-----------------|---|-|-------------|-------------|---------+ +-|-+ |   | | | 
| | |   | | | |     |     |   |     | | |   |   |       |       |       |   |       |         |   | | | | |           | |             |   |   | |             |           | |         | | | | |   | | | 
| | +-+ | | | |     |     |   | +-+ | | |   |   |       |       |       |   |       |         |   | | | | |           | |             |   |   | |             |           | +-----------+ | | |   | | | 
| |   | | | | |     |     |   | | | | | |   |   |       |       |       |   |       |         |   | | | | |           | |             |   |   | |             |           |           |   | | |   | | | 
| |   +-----|-|-+   |     |   | +-|-|-|-------+ |       |       | +---+ |   |       |         |   | | +-----------------------+       |   |   | |             |           |           |   | | |   | | | 
| |     | | | | |   |     |   |   | | | |   | | |       |       | |   | |   |       |         |   | |   | |           | |     |       |   |   | |             |           |           |   | | |   | | | 
| |     | | | +-|---------|---|---|-|-|-|---|---|---+   |       | |   | |   |       |         |   | |   | |           | |     |       |   |   | |             |           |           |   | | |   | | | 
| |     | | |   |   |     |   |   | | | |   | | |   |   |       | |   | |   |       |         |   | |   | |           | |     |       |   |   | |             |           |           |   | | |   | | | 
| |     | | |   |   |     |   | +-+ | | +-----|-|-------|-------------|-----|-----------------|---|-|-----|-----------|-|-----|-------|-----------------------------------|---------------|---------+ | 
| |     | | |   |   |     |   | |   | |     | | |   |   |       | |   | |   |       |         |   | |   | |           | |     |       |   |   | |             |           |           |   | | |   |   | 
| | +-----|-|---|-------------|-|-------------------|-------------|---|-|-----------|---------|---------|-----------------------------+   | +-|---------------|-+     +---------------|---|-|-------+ | 
| | |   | | |   |   |     |   | |   | |     | | |   |   |       | |   | |   |       |         |   | |   | |           | |     |           | | | |             | |     |   |           |   | | |   | | | 
| +-|-----|-|-------|-----|-----|-+ | | +-----|-|-------|---------------------------+         |   | |   | |           | |     |           | | | |             | |     |   |           +-----|-+   | | | 
|   |   | | |   |   |     |   | | | | | |   | | |   |   |       | |   | |   |                 |   | |   | |           | |     |           | | | |             | |     |   |               | |     | | | 
|   |   | | |   |   |     |   | | | | | |   | | |   |   |       | |   | |   |         +------I|---|-------|-----------|-|---------------------|---------------|-------|---|-+         +-------+   | | | 
|   |   | | |   |   |     |   | | | | | |   | | |   |   |       | |   | |   |         |       |   | |   | |           | |     |           | | | |             | |     |   | |         |   | | |   | | | 
|   |   | | |   |   |     |   +-|---|-|-|-----+ |   |   |       | |   | |   |         |       |   | |   | |       +---|-------|----Z------------|-------------|-----------|-----------|-+ | | |   | | | 
|   |   | | |   |   |     |     | | | | |   |   |   |   |       | |   | |   |         |       |   | |   | |       |   | |     |           | | | |             | |     |   | |         | | | | |   | | | 
|   |   +-|---------------|-----|---|-|-----|---+   |   |       | |   | |   |         |       |   | |   | |       |   | |     |     +-----------|-------------|-------------|-+       | | | | |   | | | 
|   |     | |   |   |     |     | | | | |   |       |   |       | |   | |   |         |       |   | |   | |       |   | |     |     |     | | | |             | |     |   | | |       | | | | |   | | | 
|   |     | |   |   |     |     +---|-|-----------+ | +-|-------+ |   | +-------------|-------|---|-----|---------|---|-|-------------------|-|---------------|-------|-----+ |       | | | | |   | | | 
|   |     | |   |   |     |       | | | |   |     | | | |         |   |     |         |       |   | |   | |       |   | |     |     |     | | | |             | |     |   |   |       | | | | |   | | | 
|   |     | |   |   |     |       | | | |   |     | | | |       +-|---|---------------|-------|---|-------|-------|---|-----------+ +---------------------------+     |   |   |     +-|---|-|-|-+ | | | 
|   |     | |   |   |     |       | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   | |     |   |       | | | |             |       |   |   |     | | | | | | | | | | 
|   |     | |   |   |     |       | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   | |     |   |       | | | |             |       |   |   |     | | | | | | | | | | 
|   |     | |   |   |     |       | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   | |     |   |       | | | |             |       |   |   |     | | | | | | | | | | 
|   |     | |   |   |     | +-----|---|-|---------|-|-|---------|-----------|---------|-------------|-------------------+     |   |       | | | |             |       |   |   |     | | | | | | | | | | 
|   |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       |   |       | | | |             |       |   |   |     | | | | | | | | | | 
|   |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | +-|-----+ | | | |             | +-------------|-------|-|-|-+ | | | | | 
|   |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | | |     | | | | |             | |     |   |   |     | | | |   | | | | | 
+---------|-----|---------|-|-----|-|-|-------------------------|-|---------|---------|-----------|-|---|---------|---|-------|-------------|-|-|---------+   | |     |   |   |     | | | |   | | | | | 
    |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | | |     | | | | |         |   | |     |   |   |     | | | |   | | | | | 
    |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | | |     | | | | |         |   | |     |   |   +-+   | | | |   | | | | | 
    |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | | |     | | | | |         |   | |     |   |     |   | | | |   | | | | | 
    |     | |   |   |     | |     | +-|-|---|-------|-----------------------|---------------------|-+   | |       |   |       | | |     | | | | |         |   | |     |   |     |   | | | |   | | | | | 
    |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       | M |     | | | | |         |   | |     |   |     |   | | | |   | | | | | 
+---|-------|---|-----------------|---|-|---|-----------|-------------------|---------------------|-----|---------|---|-------|-|-|-----------+ |         |   | |     |   |     |   | | | |   | | | | | 
|   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       | | |     | | |   |         |   | |     |   |     |   | | | |   | | | | | 
|   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       | | |     | | |   |         |   | |     |   |     |   | | | |   | | | | | 
|   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       | | |     | | |   |         |   | |     |   |     |   | | | |   | | | | | 
|   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       +-|-----+ | | |   |         |   | |     |   |     +---+ | | |   | | | | | 
|   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |         | |   | | | |   |         |   | |     |   |           | | |   | | | | | 
|   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |         | |   | | | |   |         |   | |     |   |           | | |   | | | | | 
|   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |         | |   | | | |   |         |   | |     |   |           | | |   | | | | | 
|   |     | |   |   |     | |     |   | |   |     | | | +-------|---------------------|-+     |   |     | |       |   |         | |   | | | |   |         |   | +-+ +-------------------|-+   | | | | | 
|   |     | |   |   |     | |     |   | |   |     | | |         | |   |     |         | |     |   |     | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     | | | | | 
|   +-+   | |   |   |     | | +-----+ | |   |     | | |       +-|-----------|---------------------|-----------------------------|-------|-|-----|-------------|-------|-----------------------|-+ | | | 
|     |   | |   |   |     | | |   | | | |   |     | | |       | | |   |     |         | |     |   |     | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
|   +-|-----|-------|-----|---|-----|-|-----|---------|-----+ | | |   |     |   +-----|-|-----|---|-+   | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
|   | |   | |   |   |     | | |   | | | |   |     | | |     | | | |   |     |   |     | |     |   | |   | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
|   | +---+ |   |   | +---+ | |   | | | |   | +---|---------|-|---|---------|---+     | |     |   | |   | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
|   |       |   |   | |     | |   | | | |   | |   | | |     | | | |   |     |         | |     |   | |   | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
|   |       |   |   | |     | | +---|---|-----|-----|-+     | | | |   |     |         | |     |   | |   | |       |   |         | |   | | +-|---|---------|-----------------------------------|---+ | | 
|   |       |   |   | |     | | | | | | |   | |   | |       | | | |   |     |         | |     |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
| +-----------------|-------|-----|---------------|-|-------|---|-----------+   +-----|-+     |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
| | |       |   |   | |     | | | | | | |   | |   | |       | | | |   |         |     |       |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
| | |   +---|---+   | |     | | | | | | |   | |   | |       | | | |   |         |     |       |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
| | |   |   |       | |     | | | | | | |   | |   | |       | | | |   |         |     |       |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
| | |   | +-|-----------------|-|---|---+   | |   | |       | | | |   |         |     |       |   +-------|-------|-------------|-|-----|-------|---------|---------|-----|-----------|-----------+ | | 
| | |   | | |       | |     | | | | | |     | |   | |       | | | |   |         |     |       |     |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |   | | | 
| | | +-|-|-|-------|-|-----|-|-|---|-|-----------+ |       | | | |   |       +-------|-------|---------|---------|-----+       | | +-|-+   |   | +---+   |   |   | | |   |           | |     |   | | | 
| | | | | | |       | |     | | | | | |     | |     |       | | | |   |       | |     |       |     |   | |       |   | |       | | | |     |   | |   |   |   |   | | |   |           | |     |   | | | 
| | | | | | |     +-|-|-----|-----|-|-------|-------|-------------------------+ |     |       |     |   | |       |   | +---------|-----------+ | |   |   |   |   | | |   |           | |     |   | | | 
| | | | | | |     | | |     | | | | | |     | |     |       | | | |   |         |     |       |     |   | |       |   |         | | | |     | | | |   |   |   |   | | |   |           | |     |   | | | 
| | | +---|-------+ | | +-+ | | | | | |     | |     |       | | +-|-------------|-------------|---------|---------+   | +-------|---|-------|---|---------|-----------------------------|-----+   | | | 
| | |   | | |       | | | | | | | | | |     | |     |       | |   |   |         |     |       |     |   | |           | |       | | | |     | | | |   |   |   |   | | |   |           | |         | | | 
| | |   | | |       | | +-|-|-+ +-|---|-------|-----|---+   | |   | +-----------|-----|-------------|---|-|-----------------------|-|---------------------|---|-------|---------------|-|-------+ | | | 
| | |   | | |       | |   | |     | | |     | |     |   |   | |   | | |         |     |       |     |   | |           | |       | | | |     | | | |   |   |   |   | | |   |           | |       | | | | 
| | |   | | |       | | +---|-+   | | |     | |     | +-----|-|---|-|-----------|-------+     |     |   | |           | |       | | | |     | | | |   |   |   |   | | |   |           | |       | | | | 
| | |   | | |       | | | | | |   | | |     | |     | | |   | |   | | |         |     | |     |     |   | |           | |       | | | |     | | | |   |   |   |   | | |   |           | |       | | | | 
| | |   | | |       | | | | | | +-+ | |     | |     | +-----|-----|-+ |         |     | |     |     |   | |           | |     +---|-|-|-----+ | | |   +---|-------|-------|-----------|---+     | | | | 
| | |   | | |       | | | | | | |   | |     | |     |   |   | |   |   |         |     | |     |     |   | |           | |     | | | | |       | | |       |   |   | | |   |           | | |     | | | | 
| | |   | | |       | | | | | | |   | |     | |     |   |   | |   |   |         |     | |     |     |   | |           | |     | | | | |       | | |       |   |   | | |   |           | | |     | | +-+ 
| | |   | | |       | | | | | | |   | |     | |     |   |   | |   |   |         |     | |     |     |   | |           | |     | | | | |       | | |       |   |   | | |   |           | | |     | |     
| | |   | | |       | +---|-|-|-------|-------|-------------|-|-----------------|-------------------+   | |           | |     | | | | |     +-|-|-|-------|-------------------------------------|-----+ 
| | |   | | |       |   | | | | |   | |     | |     |   |   | |   |   |         |     | |     |         | |           | |     | | | | |     | | | |       |   |   | | |   |           | | |     | |   | 
| | |   | | |     +-|-------------+ O | +---|-|---------|-+ | |   |   |         |     | |     |         | |           | |     | | | | |     | | | |     +-+   | +-|-|-----------+     | | |     | | +-+ 
| | |   | | |     | |   | | | | | |   | |   | |     |   | | | |   |   |         |     | |     |         | |           | |     | | | | |     | | | |     |     | | | | |   |     |     | | |     | | |   
| | |   | +-|-------|---|-------|-|---|-------------|---|-|-------|-------------------|-|-----|---------+ |           | |     | | | | |     | | | |     |     | | | | |   |     |     | | |     | | |   
| | |   |   |     | |   | | | | | |   | |   | |     |   | | | |   |   |         |     | |     |           |           | |     | | | | |     | | | |     |     | | | | |   |     |     | | |     | | |   
| | |   | +-|-----|-----|-|---|---|---|-----+ |     |   | +-------|-+ |         |     | |     |           |   +---------|-------|-|---|-----|-|-+ |     |     | | | | |   |     |     | | |     | | |   
| | |   | | |     | |   | | | | | |   | |     |     |   |   | |   | | |         |     | |     |           |   |       | |     | | | | |     | |   |     |     | | | | |   |     |     | | |     | | |   
| | |   | | |     | |   | | | | | | +---+     |     |   |   +-|-----|-|---------|-------------------------------------|---------|---|-------|-----|---+ |     | | | | |   |     |     | | |     | | |   
| | |   | | |     | |   | | | | | | | |       |     |   |     |   | | |         |     | |     |           |   |       | |     | | | | |     | |   |   | |     | | | | |   |     |     | | |     | | |   
| | |   | | |     | | +-|-|---|---|-|-|-------------|---------------|-----------------|-|-----|-----------|---|-------|-------+ | | | |     | |   |   | |     | | | | |   |     |     | | |     | | |   
| | |   | | |     | | | | | | | | | | |       |     |   |     |   | | |         |     | |     |           |   |       | |       | | | |     | |   |   | |     | | | | |   |     |     | | |     | | |   
| | | +-------------|-|-----|---|-|---|-------------|---|---+ |   | | |         |     | |     |           |   +-------|-----------|-|-------|-|---|-----|-----|-+ | | |   |     |     | | |     | | |   
| | | | | | |     | | | | | | | | | | |       |     |   |   | |   | | |         |     | |     |           |           | |       | | | |     | |   |   | |     |   | | |   |     |     | | |     | | |   
+-|-+ | | | |     | | | | | | | | | | |       |     |   +---|-|---|-|-|---------|-----|-------|-------------------------------------|---------|---------------|-----|-|---------------|---------+ | |   
  |   | | | |     | | | | | | | | | | |       |     |       | |   | | |         |     | |     |           |           | |       | | | |     | |   |   | |     |   | | |   |     |     | | |       | |   
  |   | | | |     | | | | | | | | | | |       |   +-|-------------|-|-----------|-------------|---------------------------------|---|-|-----------------------|-----|-----------------|---+       | |   
  |   | | | |     | | | | | | | | | | |       |   | |       | |   | | |         |     | |     |           |           | |       | | | |     | |   |   | |     |   | | |   |     |     | |         | |   
  |   | | | |     | | | | | | | | +-|-|-------|---|-|-------------|-------------|-------------------------------------+ |     +-|---|-------|-----|-----------|---+ | |   |     |     | |         | |   
  |   | | | |     | | | | | | | |   | |       |   | |       | |   | | |         |     | |     |           |             |     | | | | |     | |   |   | |     |     | |   |     |     | |         | |   
  |   | | | |     | | | | | | | |   | | +-------+ | | +-----|-----+ | |         |     | |     |           |             |     | | | | |     | +--N|-----|-----|-----|---+ |     +-------|-+       | |   
  |   | | | |     | | | | | | | |   | | |     | | | | |     | |     | |         |     | |     |           |             |     | | | | |     |     |   | |     |     | | | |           | | |       | |   
  | +-+ | | |     | | +---------|-----|-|-------+ | | |     +-|---+ | |         |     +-|-----|-----------|---------------------|---|-------|-----|-----------|-----|-+ | |           | | |       | |   
  | |   | | |     | |   | | | | |   | | |     |   | | |       |   | | |         |       |     |           |             |     | | | | |     |     |   | |     |     |   | |           | | |       | |   
  | | +---|-------|-|---|-|---------|-|-------+   | | |     +-------|-|-----------------|-----|-----------|-------------|-------------|-------+   |   | |     |     |   | |           | | |       | |   
  | | | | | |     | |   | | | | |   | | |         | | |     | |   | | |         |       |     |           |             |     | | | | |     | |   |   | |     |     |   | |           | | |       | |   
  | | | | | |     | |   | +-|-------+ | |         | | |     | |   | | |         |       |     |           |             |     | | | | |     | |   |   | |     |     |   | |           | | |       | |   
  | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |       |     |           |             |     | | | | |     | |   |   | |     |     |   | |           | | |       | |   
  | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |       |     |           |             |     | | | | +-------|---|---|-|-----------|-----|-----------|---|---+   | |   
  | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |       |     |           |             |     | | | |       | |   |   | |     |     |   | |           | | |   |   | |   
  | | | | | |     | +-------|-|-------|-|-------------------|-|-------|-------------------------------------------------|-----|-|-----------|-|---|-----|-----------|---|-|-----------+ | |   |   | |   
  | | | | | |     |     |   | | |     | |         | | |     | |   | | |         |       |     |           |             |     | | | |       | |   |   | |     |     |   | |             | |   |   | |   
  | | | | | |     | +---|-------|-------------------|-|-------|---|-|-----------------+ |     |           |             | +---+ | | |       | |   |   | |     |     |   | |             | |   |   | |   
  | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |     | |     |           |             | |     | | |       | |   |   | |     |     |   | |             | |   |   | |   
  | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |     | |     |           |             | |     | | |       | |   |   | |     |     |   | |             | |   |   | |   
  | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |     | |     |           |             | |     | | |       | |   |   | |     |     |   | |             | |   |   | |   
  | | | | | |     | |   |   | | |   +---|-----+   | | |     | |   | | |         |     | |     |           |             | |     | | +-------|-|---|-----|-----------|-------------------|-----+   | |   
  | | | | | |     | |   |   | | |   | | |     |   | | |     | |   | | |         |     | |     |           |             | |     | |         | |   |   | |     |     |   | |             | |       | |   
  | | | +-|-----------------|-+ |   | | |     |   | | |     | |   | | |         |     | |     |           |             | |     | |         | |   |   | +-----|-----|-+ | |   +-+       | |       | |   
  | | |   | |     | |   |   |   |   | | |     |   | | |     | |   | | |         |     | |     |           |             | |     | |         | |   |   |       |     | | | |   | |       | |       | |   
  +-------|-|-----|-|---|---|---------|-|-----|---|---|-----|-|---|---|---------------|-------|-----------|-------------|-------------------|-----------------------|-|-|-----|---------|-|---------|-+ 
    | |   | |     | |   |   |   |   | | |     |   | | |     | |   | | |         |     | |     |           |             | |     | |         | |   |   |       |     | | | |   | |       | |       | | | 
    | |   | |     | |   |   |   |   | | |     |   | | |   +-|-|-----|-|---------|-------|-------------------------------|-|-----|-----------------|---------------------|-----|-+       | |       | | | 
    | |   | |     | |   |   |   |   | | |     |   | | |   | | |   | | |         |     | |     |           |             | |     | |         | |   |   |       |     | | | |   |         | |       | | | 
    | |   +---------------------|---|-------------|---|---|-|-|-+ +-+ |         |     | |     |           | +-------------------------------|---------|---+   |     | | | |   |         | |       | | | 
    | |     |     | |   |   |   |   | | |     |   | | |   | | | |     |         |     | |     |           | |           | |     | |         | |   |   |   |   |     | | | |   |         | |       | | | 
    | |     |     | |   |   |   +---|---------|-----|-|---|-+ | |     +---------|-----|---------+         | |           | |   +-|-------+   | |   |   |   |   |     | | | |   |         | |       | | | 
    | |     J     | |   |   |       | | |     |   | | |   |   | |               |     | |     | |         | |           | |   | | |     |   | |   |   |   |   |     | | | |   |         | |       | | | 
    +---+   |     | |   |   |       | | |     |   | | |   |   | |               |     | |     | |         +-------------------|---------|-------------|---|---------|-|-------------+   | |       | | | 
      | |   |     | |   |   |       | | |     |   | | |   |   | |               |     | |     | |           |           | |   | | |     |   | |   |   |   |   |     | | | |   |     |   | |       | | | 
      | |   |     | |   |   |       | | |     | +-|-|--C--------+               |     | |     | |           |           | |   | | |     |   | |   |   |   |   |     | | | |   |     |   | |       | | | 
      | |   |     | |   |   |       | | |     | | | | |   |   |                 |     | |     | |           |           | |   | | |     |   | |   |   |   |   |     | | | |   |     |   | |       | | | 
    +-------------------|---------------|---------|-|-|---------------------------------|-----|-|-------------------------------|-|-----|-------------|-------------|---|-----|-----|---|-----------+ | 
    | | |   |     | |   |   |       | | |     | | | | |   |   |                 |     | |     | |           |           | |   | | |     |   | |   |   |   |   |     | | | |   |     |   | |       |   | 
    | | | +-------------|-----------------------|-|-|-|-------|---------+       |     | +-----|-------------|-------------|---|-------------|-|-+ |   |   |   |     | | | |   |     |   | |       |   | 
    | | | | |     | |   |   |       | | |     | | | | |   |   |         |       |     |       | |           |           | |   | | |     |   | | | |   |   |   |     | | | |   |     |   | |       |   | 
    | | | | |     | |   |   |       | | |     | | +-------|---|---------|---+   |     |       | |           +-------------------|-|-----------|-----------|---------+ | | |   |     |   | |       |   | 
    | | | | |     | |   |   |       | | |     | |   | |   |   |         |   |   |     |       | |                       | |   | | |     |   | | | |   |   |   |       | | |   |     |   | |       |   | 
    | | | | |     | | +---+ |       | | |     | |   | |   |   +---+     |   +---|-----------------------------------------|-+ | | |     |   | | | |   |   |   |       | | |   | +-------|-----------+ | 
    | | | | |     | | | | | |       | | |     | |   | |   |       |     |       |     |       | |                       | | | | | |     |   | | | |   |   |   |       | | |   | |   |   | |       | | | 
    | | | | |     | | | | | +-+     | | |     | |   +-|---|-------|-----|-------|---------------|-----------------------|---|-+ | |     |   | | | |   |   |   |       | | |   | |   |   | |       | | | 
    | | | | |     | | | | |   |     | | |     | |     |   |       |     |       |     |       | |                       | | |   | |     |   | | | |   |   |   |       | | |   | |   |   | |       | | | 
    | | | | |     | | | | | +-|-----------------------------------------+       |     |       | |                       | +-|-+ | |     |   +-----+   | +-----|-----------|---------|-----+       | | | 
    | | | | |     | | | | | | |     | | |     | |     |   |       |             |     |       | |                       |   | | | |     |     | |     | | |   |       | | |   | |   |   |         | | | 
    | | | | |     | | | | | | |     | | |     | |     |   |   +-------------------------------|---------------+         |   +-|-----------------|-----|-----------------|-|-----|-------------------+ | 
    | | | | |     | | | | | | |     | | |     | |     |   |   |   |             |     |       | |             |         |     | | |     |     | |     | | |   |       | | |   | |   |   |         |   | 
  +-+ | | | +-----|-----------+     | | |     +-|-----|---|---|-----------------|-------------|-|-----------------------+ +---|---+     |     | |     | | |   |       | | |   | |   |   |         |   | 
  |   | | |       | | | | | |       | | |       |     |   |   |   |             |     |       | |             |           |   | |       |     | |     | | |   |       | | |   | |   |   |         |   | 
  |   | | |       | | | | | |       | | |       |     |   +-+ |   |           +-|-----------------------------|-----------------|-------------|-------|---------------|---|---+ |   |   |         |   | 
  |   | | |       | | | | | |       | | |       |     |     | |   |           | |     |       | |             |           |   | |       |     | |     | | |   |       | | |     |   |   |         |   | 
+-|---------------|-|---|-|---------|---+       |   +-------|-------------------|-------+     | | +---+       |           |   | |       |     | |     | +-------------+ | |     |   |   |         |   | 
| |   | | |       | | | | | |       | |         |   | |     | |   |           | |     | |     | | |   |       |           |   | |       |     | |     |   |   |         | |     |   |   |         |   | 
+-----|---|-+     | | | | | |       | |         |   | |     | |   +-------------|-------------|---|---|-------|---------+ |   | |       |     | |     |   |   |         | |     |   |   |         |   | 
  |   | | | |     | | | | | |       | |         |   | |     | |               | |     | |     | | |   |       |         | |   | |       |     | |     |   |   |         | |     |   |   |         |   | 
  |   | | | |     | | | | | |       | |         |   | |     | |             +---|-------|-------|-|---|-------|-----------|---|---------------------------|---|-----------|---------|---|-----------+ | 
  |   | | | |     | | | | | |       | |         |   | |     | |             | | |     | |     | | |   |       |         | |   | |       |     | |     |   |   |         | |     |   |   |         | | | 
  |   | | | +-------+ | | | +-------|-|-------------|-|-----+ |             | | |     | +-----|-|-|-----------------------|---|---------|---+ | |     |   |   |         | |     |   |   |         | | | 
  |   | | |       |   | | |         | |         |   | |       |             | | |     |       | | |   |       |         | |   | |       |   | | |     |   |   |         | |     |   |   |         | | | 
  |   | +---------|-+ | | |       +-+ |         |   | +-------|-------------|-|-------|---------------------------------|-----|-|-+     |   | | |     |   |   |         | |     |   |   |         | | | 
  |   |   |       | | | | |       |   |         |   |         |             | | |     |       | | |   |       |         | |   | | |     |   | | |     |   |   |         | |     |   |   |         | | | 
+-+ +-+ +-----------|-+ | |       |   |         |   |         |             | | +-------------|-+ |   |       |         | |   | | |     |   | | |     |   |   |     +---|-|-----|-------+         | | | 
|   |   | |       | |   | |       |   |         |   |         |             | |       |       |   |   |       |         | |   | | |     |   | | |     |   |   S     |   | |     |   |             | | | 
| +-+   | |       | |   | |       |   |         |   |         | +-----------------------------|---|-----------+         | +-------|-----|-----|-+     |   |   |     |   | |     |   |             | | | 
| |     | |       | |   | |       |   |         |   |         | |           | |       |       |   |   |                 |     | | |     |   | |       |   |   |     |   | |     |   |             | | | 
+-+     | |       | |   | |       |   |         |   |         | |           | |       +-------|-------|-----------------|-----+ | +-----|-----|-------+   |   |     |   | |     |   |     +-------|-+ | 
        | |       | |   | |       |   |         |   |         | |           | |               |   |   |                 |       |       |   | |           |   |     |   | |     |   |     |       |   | 
        | |       | |   | |       |   |         |   |         | |           +-----------------+   |   +-----------------|---------------------|-----------|---------|-----|-----+   |     |       |   | 
        | |       | |   | |       |   |         |   |         | |             |                   |                     |       |       |   | |           |   |     |   | |         |     |       |   | 
        | |       | +-------------|---|--U--------------------|-+             |     +-------------|-------------------------------------------------------|---+     |   | |         |     |       |   | 
        | |       |     | |       |   |         |   |         |               |     |             |                     |       |       |   | |           |         |   | |         |     |       |   | 
        | |       |     | |       |   |         |   |         |               |     +-------------|-----------------------------|-----------------------------------------|---------+     |     +-|-+ | 
        | |       |     | |       |   |         |   |         |               |                   |                     |       |       |   | |           |         |   | |               |     | | | | 
    +---+ +-------|-------|-------|-----------------|---------------------------------------------|-------------------------------------------|---------------------|---|-|---------------|-----+ | | | 
    |             |     | |       |   |         |   |         |               |                   |                     |       |       |   | |           |         |   | |               |       | | | 
    |             +-----|-+       |   +---------+   |         |               |                   |         +-----------+       |       |   | |           +---------+   | |               |       | | | 
    |                   |         |                 |         |               |                   |         |                   |       |   | |                         | |               |       | | | 
    |                   |         |                 +-------------------------|-------------------|---------|---------------------------|---------------------------------+               |   +-----+ | 
    |                   |         |                           |               |                   |         |                   |       |   | |                         |                 |   |   |   | 
    |                   |         |                           +---------------------------------------------+                   |       |   +---------------------------+                 +---+   |   | 
    |                   |         |                                           |                   |                             |       |     |                                                   |   | 
    +-------------------+         +----------------------------------------T------------------------------------------------------------------|-------------------------------------------------+ |   | 
                                                                              |                   |                             |       |     |                                                 | |   | 
                                                                              +-------------------|-------------------------------+     |     |                                                 +-|---+ 
                                                                                                  |                             | |     |     |                                                   |     
                                                                                                  +-----------------------------+ +-----+     +---------------------------------------------------+     
                                                                                                                                                                                                        